document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".ad-map").forEach(t=>{const e=t.querySelectorAll(".ad-map__locations__item"),a=t.querySelectorAll(".ad-map__address__panel"),n=t.querySelector(".ad-map__map"),l=t.querySelector(".ad-map__container")?.classList.contains("is-single-map");let o=t.querySelectorAll(".ad-map__map__panel");const r=t.querySelector(".ad-map__leaflet"),s=t=>{e.forEach((e,a)=>e.classList.toggle("is-active",a===t)),a.forEach((e,a)=>e.classList.toggle("is-active",a===t))};let i=null,c=[];const d=t.querySelector(".ad-map__container"),m=d?.getAttribute("data-fly-duration"),u=Math.max(.1,parseFloat(m||"0.9")||.9),p=()=>Array.from(e).map(t=>{const e=t.getAttribute("data-lat"),a=t.getAttribute("data-lng"),n=t.textContent?.trim()||"";return e&&a?{lat:parseFloat(e),lng:parseFloat(a),title:n}:null}),f=e=>{l?(async e=>{if(s(e),i){const t=p()[e];if(t){i.flyTo([t.lat,t.lng],Math.max(i.getZoom(),16),{duration:u});const a=c[e];return void(a&&setTimeout(()=>a.openPopup(),Math.min(800,700*u)))}}const a=t.querySelector(".ad-map__map__panel iframe"),l=Array.from(t.querySelectorAll(".ad-map__map__panel")).map(t=>t.querySelector("iframe")?.getAttribute("src")).filter(Boolean)[e]||"";a&&l&&(n?.classList.add("is-sliding"),a.setAttribute("src",l),setTimeout(()=>n?.classList.remove("is-sliding"),380))})(e):(t=>{s(t),o.forEach((e,a)=>e.classList.toggle("is-active",a===t))})(e)};e.forEach((t,e)=>{t.addEventListener("click",()=>f(e))});const _=[...e].findIndex(t=>t.classList.contains("is-active")),g=_>=0?_:0;(async t=>{if(!l||!r)return!1;const e=p().filter(Boolean);if(!e.length)return!1;const a=await new Promise(t=>{if(window.L&&window.L.map)return t(window.L);const e="leaflet-css",a="leaflet-js";if(!document.getElementById(e)){const t=document.createElement("link");t.id=e,t.rel="stylesheet",t.href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",document.head.appendChild(t)}const n=()=>t(window.L);if(document.getElementById(a))return window.L?n():void document.getElementById(a).addEventListener("load",n,{once:!0});const l=document.createElement("script");l.id=a,l.src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js",l.onload=n,document.head.appendChild(l)});if(!a)return!1;i=a.map(r,{zoomControl:!0,attributionControl:!0});const n=e[Math.max(0,t||0)]||e[0];return a.tileLayer("https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",{maxZoom:20,subdomains:"abcd"}).addTo(i),i.setView([n.lat,n.lng],16),c=e.map(t=>a.marker([t.lat,t.lng]).addTo(i).bindPopup(t.title)),!0})(g).then(()=>f(g))})});